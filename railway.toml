[build]
builder = "nixpacks"
buildCommand = "pnpm install && pnpm run build"

[deploy]
startCommand = "NODE_ENV=production node dist/index.js"
healthcheckPath = "/"
healthcheckTimeout = 300
restartPolicyType = "on_failure"

[build.nixpacksPlan.phases.setup]
nixPkgs = ["nodejs_22", "nodePackages_latest.pnpm"]

[build.nixpacksPlan.variables]
NODE_VERSION = "22"
